# Preparing data for hypothesis test
fruit_retail_cost_avg$Fruits <- dataFruit$data.Fruit2022
fruits_new_order <- c("Fruits", "RetailCost_2013", "RetailCost_2016", "RetailCost_2020", "RetailCost_2022")
fruit_retail_cost_avg <- fruit_retail_cost_avg[, fruits_new_order]
# Preparing data for hypothesis test
fruit_retail_cost_avg$Fruits <- dataFruit$data.Fruit2022
fruits_new_order <- c("Fruits", "RetailCost_2013", "RetailCost_2016", "RetailCost_2020", "RetailCost_2022")
fruit_retail_cost_avg <- fruit_retail_cost_avg[, fruits_new_order]
# Preparing data for hypothesis test
fruit_retail_cost_avg$Fruits <- dataFruit$data.Fruit2022
fruits_new_order <- c("Fruits", "RetailCost_2013", "RetailCost_2016", "RetailCost_2020", "RetailCost_2022")
fruit_retail_cost_avg <- fruit_retail_cost_avg[, fruits_new_order]
fruit_retail_cost_avg
# Load ggplot2
library(ggplot2)
data <- read.csv("ProjectData.csv")
dataFruit <- data.frame(
data$Fruit2022, data$FormF2022, data$RetailCostPer.Pound.PintF2022,
data$Fruit2020, data$FormF2020, data$RetailCostPer.Pound.PintF2020,
data$Fruit2016, data$FormF2016, data$RetailCostPer.Pound.PintF2016,
data$Fruit2013, data$FormF2013, data$RetailCostPer.Pound.PintF2013
)
dataVeg <- data.frame(
data$Vegetable2022, data$FormV2022, data$RetailCostPer.Pound.PintV2022,
data$Vegetable2020, data$FormV2020, data$RetailCostPer.Pound.PintV2020,
data$Vegetable2016, data$FormV2016, data$RetailCostPer.Pound.PintV2016,
data$Vegetable2013, data$FormV2013, data$RetailCostPer.Pound.PintV2013
)
#Clean up the fruit/veg data (remove na rows):
print("Note: Some fruits/vegetables do not have price data for all 4 years can be excluded (example: Zucchinis only have data in 2022/2020)")
dataFruit <- na.omit(dataFruit)
dataVeg <- na.omit(dataVeg)
# Barplot
ggplot(dataFruit, aes(x=data.RetailCostPer.Pound.PintF2022, y=data.Fruit2022, color = data.FormF2022, shape = data.FormF2022)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataFruit, aes(x=data.RetailCostPer.Pound.PintF2020, y=data.Fruit2020, color = data.FormF2020, shape = data.FormF2020)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataFruit, aes(x=data.RetailCostPer.Pound.PintF2016, y=data.Fruit2016, color = data.FormF2016, shape = data.FormF2016)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataFruit, aes(x=data.RetailCostPer.Pound.PintF2013, y=data.Fruit2013, color = data.FormF2013, shape = data.FormF2013)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataVeg, aes(x=data.RetailCostPer.Pound.PintV2022, y=data.Vegetable2022, color = data.FormV2022, shape = data.FormV2022)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataVeg, aes(x=data.RetailCostPer.Pound.PintV2020, y=data.Vegetable2020, color = data.FormV2020, shape = data.FormV2020)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataVeg, aes(x=data.RetailCostPer.Pound.PintV2016, y=data.Vegetable2016, color = data.FormV2013, shape = data.FormV2016)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataVeg, aes(x=data.RetailCostPer.Pound.PintV2013, y=data.Vegetable2013, color = data.FormV2013, shape = data.FormV2013)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
#U.S. Department of Agriculture, Economic Research Service. (2024). Fruit and vegetable prices.
#Large variance in fruit prices
print(dataFruit)
print(dataVeg)
# Checking the mean price across years
# Fruits
fruit_retail_cost <- data.frame(RetailCost_2013 = dataFruit$data.RetailCostPer.Pound.PintF2013,
RetailCost_2016 = dataFruit$data.RetailCostPer.Pound.PintF2016,
RetailCost_2020 = dataFruit$data.RetailCostPer.Pound.PintF2020,
RetailCost_2022 = dataFruit$data.RetailCostPer.Pound.PintF2022)
print(fruit_retail_cost)
# Vegetables
veg_retail_cost <- data.frame(RetailCost_2013 = dataVeg$data.RetailCostPer.Pound.PintV2013,
RetailCost_2016 = dataVeg$data.RetailCostPer.Pound.PintV2016,
RetailCost_2020 = dataVeg$data.RetailCostPer.Pound.PintV2020,
RetailCost_2022 = dataVeg$data.RetailCostPer.Pound.PintV2022)
print(veg_retail_cost)
summary(fruit_retail_cost) # We can see there is increase in mean prices over the time span
summary(veg_retail_cost) # We can see there is increase in mean prices over the time span
summary(veg_retail_cost) # We can see there is increase in mean prices over the time span
# Let's plot a graph to see the overall price trend
library(ggplot2)
years <- c(2013, 2016, 2020, 2022)
fruit_retail_cost_avg <- c(mean(fruit_retail_cost$RetailCost_2013),
mean(fruit_retail_cost$RetailCost_2016),
mean(fruit_retail_cost$RetailCost_2020),
mean(fruit_retail_cost$RetailCost_2022))
veg_retail_cost_avg <- c(mean(veg_retail_cost$RetailCost_2013),
mean(veg_retail_cost$RetailCost_2016),
mean(veg_retail_cost$RetailCost_2020),
mean(veg_retail_cost$RetailCost_2022))
# Line plot
plot(years, fruit_retail_cost_avg, type="o", col = "red", ylim = range(c(fruit_retail_cost_avg, veg_retail_cost_avg)), xlab = "Year", ylab = "Average Retail Cost",  main = "Average Retail Cost of Fruits and Vegetables (2013–2022)")
lines(years, veg_retail_cost_avg, type = "o", col = "blue") # Adding vegetable line to the above plot
legend("topleft", legend = c("Fruits", "Vegetables"), col = c("red", "blue"))
# We can see a gradual shift until 2020 and then a sudden hunp in 2022 for both vegetables and fruits.
# Preparing data for hypothesis test
fruit_retail_cost_avg$Fruits <- dataFruit$data.Fruit2022
fruits_new_order <- c("Fruits", "RetailCost_2013", "RetailCost_2016", "RetailCost_2020", "RetailCost_2022")
fruit_retail_cost_avg <- fruit_retail_cost_avg[, fruits_new_order]
# Preparing data for hypothesis test
fruit_retail_cost_avg
# Preparing data for hypothesis test
veg_retail_cost_avg
# Let's plot a graph to see the overall price trend
library(ggplot2)
years <- c(2013, 2016, 2020, 2022)
fruit_retail_cost_avg <- c(mean(fruit_retail_cost$RetailCost_2013),
mean(fruit_retail_cost$RetailCost_2016),
mean(fruit_retail_cost$RetailCost_2020),
mean(fruit_retail_cost$RetailCost_2022))
veg_retail_cost_avg <- c(mean(veg_retail_cost$RetailCost_2013),
mean(veg_retail_cost$RetailCost_2016),
mean(veg_retail_cost$RetailCost_2020),
mean(veg_retail_cost$RetailCost_2022))
# Line plot
plot(years, fruit_retail_cost_avg, type="o", col = "red", ylim = range(c(fruit_retail_cost_avg, veg_retail_cost_avg)), xlab = "Year", ylab = "Average Retail Cost",  main = "Average Retail Cost of Fruits and Vegetables (2013–2022)")
lines(years, veg_retail_cost_avg, type = "o", col = "blue") # Adding vegetable line to the above plot
legend("topleft", legend = c("Fruits", "Vegetables"), col = c("red", "blue"))
# We can see a gradual shift until 2020 and then a sudden hunp in 2022 for both vegetables and fruits.
# Preparing data for hypothesis test
fruit_retail_cost_avg
# Load ggplot2
library(ggplot2)
data <- read.csv("ProjectData.csv")
dataFruit <- data.frame(
data$Fruit2022, data$FormF2022, data$RetailCostPer.Pound.PintF2022,
data$Fruit2020, data$FormF2020, data$RetailCostPer.Pound.PintF2020,
data$Fruit2016, data$FormF2016, data$RetailCostPer.Pound.PintF2016,
data$Fruit2013, data$FormF2013, data$RetailCostPer.Pound.PintF2013
)
dataVeg <- data.frame(
data$Vegetable2022, data$FormV2022, data$RetailCostPer.Pound.PintV2022,
data$Vegetable2020, data$FormV2020, data$RetailCostPer.Pound.PintV2020,
data$Vegetable2016, data$FormV2016, data$RetailCostPer.Pound.PintV2016,
data$Vegetable2013, data$FormV2013, data$RetailCostPer.Pound.PintV2013
)
#Clean up the fruit/veg data (remove na rows):
print("Note: Some fruits/vegetables do not have price data for all 4 years can be excluded (example: Zucchinis only have data in 2022/2020)")
dataFruit <- na.omit(dataFruit)
dataVeg <- na.omit(dataVeg)
# Barplot
ggplot(dataFruit, aes(x=data.RetailCostPer.Pound.PintF2022, y=data.Fruit2022, color = data.FormF2022, shape = data.FormF2022)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataFruit, aes(x=data.RetailCostPer.Pound.PintF2020, y=data.Fruit2020, color = data.FormF2020, shape = data.FormF2020)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataFruit, aes(x=data.RetailCostPer.Pound.PintF2016, y=data.Fruit2016, color = data.FormF2016, shape = data.FormF2016)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataFruit, aes(x=data.RetailCostPer.Pound.PintF2013, y=data.Fruit2013, color = data.FormF2013, shape = data.FormF2013)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataVeg, aes(x=data.RetailCostPer.Pound.PintV2022, y=data.Vegetable2022, color = data.FormV2022, shape = data.FormV2022)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataVeg, aes(x=data.RetailCostPer.Pound.PintV2020, y=data.Vegetable2020, color = data.FormV2020, shape = data.FormV2020)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataVeg, aes(x=data.RetailCostPer.Pound.PintV2016, y=data.Vegetable2016, color = data.FormV2013, shape = data.FormV2016)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataVeg, aes(x=data.RetailCostPer.Pound.PintV2013, y=data.Vegetable2013, color = data.FormV2013, shape = data.FormV2013)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
#U.S. Department of Agriculture, Economic Research Service. (2024). Fruit and vegetable prices.
#Large variance in fruit prices
print(dataFruit)
print(dataVeg)
# Checking the mean price across years
# Fruits
fruit_retail_cost <- data.frame(RetailCost_2013 = dataFruit$data.RetailCostPer.Pound.PintF2013,
RetailCost_2016 = dataFruit$data.RetailCostPer.Pound.PintF2016,
RetailCost_2020 = dataFruit$data.RetailCostPer.Pound.PintF2020,
RetailCost_2022 = dataFruit$data.RetailCostPer.Pound.PintF2022)
print(fruit_retail_cost)
# Vegetables
veg_retail_cost <- data.frame(RetailCost_2013 = dataVeg$data.RetailCostPer.Pound.PintV2013,
RetailCost_2016 = dataVeg$data.RetailCostPer.Pound.PintV2016,
RetailCost_2020 = dataVeg$data.RetailCostPer.Pound.PintV2020,
RetailCost_2022 = dataVeg$data.RetailCostPer.Pound.PintV2022)
print(veg_retail_cost)
summary(fruit_retail_cost) # We can see there is increase in mean prices over the time span
summary(veg_retail_cost) # We can see there is increase in mean prices over the time span
# Let's plot a graph to see the overall price trend
library(ggplot2)
years <- c(2013, 2016, 2020, 2022)
fruit_retail_cost_avg <- c(mean(fruit_retail_cost$RetailCost_2013),
mean(fruit_retail_cost$RetailCost_2016),
mean(fruit_retail_cost$RetailCost_2020),
mean(fruit_retail_cost$RetailCost_2022))
veg_retail_cost_avg <- c(mean(veg_retail_cost$RetailCost_2013),
mean(veg_retail_cost$RetailCost_2016),
mean(veg_retail_cost$RetailCost_2020),
mean(veg_retail_cost$RetailCost_2022))
# Line plot
plot(years, fruit_retail_cost_avg, type="o", col = "red", ylim = range(c(fruit_retail_cost_avg, veg_retail_cost_avg)), xlab = "Year", ylab = "Average Retail Cost",  main = "Average Retail Cost of Fruits and Vegetables (2013–2022)")
lines(years, veg_retail_cost_avg, type = "o", col = "blue") # Adding vegetable line to the above plot
legend("topleft", legend = c("Fruits", "Vegetables"), col = c("red", "blue"))
# We can see a gradual shift until 2020 and then a sudden hunp in 2022 for both vegetables and fruits.
# Preparing data for hypothesis test
fruit_retail_cost$Fruits <- dataFruit$data.Fruit2022
fruits_new_order <- c("Fruits", "RetailCost_2013", "RetailCost_2016", "RetailCost_2020", "RetailCost_2022")
fruit_retail_cost <- fruit_retail_cost[, fruits_new_order]
print(fruit_retail_cost)
veg_retail_cost$Vegetables <- dataVeg$data.Vegetable2022
veg_new_order <- c("Vegetables", "RetailCost_2013", "RetailCost_2016", "RetailCost_2020", "RetailCost_2022")
veg_retail_cost <- veg_retail_cost[, veg_new_order]
print(veg_retail_cost)
# Saving files to reshape the data to long format using excel
write.csv(fruit_retail_cost, file = "Fruits_Retail_Cost.csv")
write.csv(veg_retail_cost, file = "Veg_Retail_Cost.csv")
# No need
# Loading the reshaped data
fruit_retail_cost <- read.csv("Fruits_Retail_Cost.csv")
veg_retail_cost <- read.csv("Veg_Retail_Cost.csv")
print(fruit_retail_cost)
print(veg_retail_cost)
# Let's see the overall trend of the price ignoring individual items
overall_model <- lm(RetailCost ~ Year, data = fruit_retail_cost)
summary(overall_model)
# Let's verify if the above results by comparing individual items across years
model_individual <- lm(Real_Cost ~ Year * Item, data = data)
# Let's verify if the above results by comparing individual items across years
model_individual <- lm(RetailCost ~ Year * Fruits, data = fruit_retail_cost)
summary(model_individual)
# No need
# Loading the reshaped data
fruit_retail_cost_reshaped <- read.csv("Fruits_Retail_Cost.csv")
veg_retail_cost_reshaped <- read.csv("Veg_Retail_Cost.csv")
print(fruit_retail_cost_reshaped)
print(veg_retail_cost_reshaped)
# Let's see the overall trend of the price ignoring individual items
overall_model <- lm(RetailCost ~ Year, data = fruit_retail_cost_reshaped)
summary(overall_model)
# We can see the price increases by $0.05714 for one unit increase in Year.
# Results also show us that p-value > 0.05, which means that the observed increase in retail cost over time could likely have occurred by random chance, and we don't have strong enough evidence to conclude that there is a real, consistent linear increase across the years.
# Load ggplot2
library(ggplot2)
data <- read.csv("ProjectData.csv")
dataFruit <- data.frame(
data$Fruit2022, data$FormF2022, data$RetailCostPer.Pound.PintF2022,
data$Fruit2020, data$FormF2020, data$RetailCostPer.Pound.PintF2020,
data$Fruit2016, data$FormF2016, data$RetailCostPer.Pound.PintF2016,
data$Fruit2013, data$FormF2013, data$RetailCostPer.Pound.PintF2013
)
dataVeg <- data.frame(
data$Vegetable2022, data$FormV2022, data$RetailCostPer.Pound.PintV2022,
data$Vegetable2020, data$FormV2020, data$RetailCostPer.Pound.PintV2020,
data$Vegetable2016, data$FormV2016, data$RetailCostPer.Pound.PintV2016,
data$Vegetable2013, data$FormV2013, data$RetailCostPer.Pound.PintV2013
)
#Clean up the fruit/veg data (remove na rows):
print("Note: Some fruits/vegetables do not have price data for all 4 years can be excluded (example: Zucchinis only have data in 2022/2020)")
dataFruit <- na.omit(dataFruit)
dataVeg <- na.omit(dataVeg)
# Barplot
ggplot(dataFruit, aes(x=data.RetailCostPer.Pound.PintF2022, y=data.Fruit2022, color = data.FormF2022, shape = data.FormF2022)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataFruit, aes(x=data.RetailCostPer.Pound.PintF2020, y=data.Fruit2020, color = data.FormF2020, shape = data.FormF2020)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataFruit, aes(x=data.RetailCostPer.Pound.PintF2016, y=data.Fruit2016, color = data.FormF2016, shape = data.FormF2016)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataFruit, aes(x=data.RetailCostPer.Pound.PintF2013, y=data.Fruit2013, color = data.FormF2013, shape = data.FormF2013)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataVeg, aes(x=data.RetailCostPer.Pound.PintV2022, y=data.Vegetable2022, color = data.FormV2022, shape = data.FormV2022)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataVeg, aes(x=data.RetailCostPer.Pound.PintV2020, y=data.Vegetable2020, color = data.FormV2020, shape = data.FormV2020)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataVeg, aes(x=data.RetailCostPer.Pound.PintV2016, y=data.Vegetable2016, color = data.FormV2013, shape = data.FormV2016)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataVeg, aes(x=data.RetailCostPer.Pound.PintV2013, y=data.Vegetable2013, color = data.FormV2013, shape = data.FormV2013)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
#U.S. Department of Agriculture, Economic Research Service. (2024). Fruit and vegetable prices.
#Large variance in fruit prices
print(dataFruit)
print(dataVeg)
# Checking the mean price across years
# Fruits
fruit_retail_cost <- data.frame(RetailCost_2013 = dataFruit$data.RetailCostPer.Pound.PintF2013,
RetailCost_2016 = dataFruit$data.RetailCostPer.Pound.PintF2016,
RetailCost_2020 = dataFruit$data.RetailCostPer.Pound.PintF2020,
RetailCost_2022 = dataFruit$data.RetailCostPer.Pound.PintF2022)
print(fruit_retail_cost)
# Vegetables
veg_retail_cost <- data.frame(RetailCost_2013 = dataVeg$data.RetailCostPer.Pound.PintV2013,
RetailCost_2016 = dataVeg$data.RetailCostPer.Pound.PintV2016,
RetailCost_2020 = dataVeg$data.RetailCostPer.Pound.PintV2020,
RetailCost_2022 = dataVeg$data.RetailCostPer.Pound.PintV2022)
print(veg_retail_cost)
summary(fruit_retail_cost) # We can see there is increase in mean prices over the time span
summary(veg_retail_cost) # We can see there is increase in mean prices over the time span
# Let's plot a graph to see the overall price trend
library(ggplot2)
years <- c(2013, 2016, 2020, 2022)
fruit_retail_cost_avg <- c(mean(fruit_retail_cost$RetailCost_2013),
mean(fruit_retail_cost$RetailCost_2016),
mean(fruit_retail_cost$RetailCost_2020),
mean(fruit_retail_cost$RetailCost_2022))
veg_retail_cost_avg <- c(mean(veg_retail_cost$RetailCost_2013),
mean(veg_retail_cost$RetailCost_2016),
mean(veg_retail_cost$RetailCost_2020),
mean(veg_retail_cost$RetailCost_2022))
# Line plot
plot(years, fruit_retail_cost_avg, type="o", col = "red", ylim = range(c(fruit_retail_cost_avg, veg_retail_cost_avg)), xlab = "Year", ylab = "Average Retail Cost",  main = "Average Retail Cost of Fruits and Vegetables (2013–2022)")
lines(years, veg_retail_cost_avg, type = "o", col = "blue") # Adding vegetable line to the above plot
legend("topleft", legend = c("Fruits", "Vegetables"), col = c("red", "blue"))
# We can see a gradual shift until 2020 and then a sudden hunp in 2022 for both vegetables and fruits.
# Preparing data for hypothesis test
fruit_retail_cost$Fruits <- dataFruit$data.Fruit2022
fruits_new_order <- c("Fruits", "RetailCost_2013", "RetailCost_2016", "RetailCost_2020", "RetailCost_2022")
fruit_retail_cost <- fruit_retail_cost[, fruits_new_order]
print(fruit_retail_cost)
veg_retail_cost$Vegetables <- dataVeg$data.Vegetable2022
veg_new_order <- c("Vegetables", "RetailCost_2013", "RetailCost_2016", "RetailCost_2020", "RetailCost_2022")
veg_retail_cost <- veg_retail_cost[, veg_new_order]
print(veg_retail_cost)
# Saving files to reshape the data to long format using excel
write.csv(fruit_retail_cost, file = "Fruits_Retail_Cost.csv")
write.csv(veg_retail_cost, file = "Veg_Retail_Cost.csv")
# Let's do a hypothesis test to verify if the mean costs of fruits have significantly changed before vs. after 2020
print(fruit_retail_cost)
# Let's do a hypothesis test to verify if the mean costs of fruits have significantly changed before vs. after 2020
print(fruit_retail_cost)
fruit_2013_avg <- mean(fruit_retail_cost$RetailCost_2013)
fruit_2016_avg <- mean(fruit_retail_cost$RetailCost_2016)
fruit_2020_avg <- mean(fruit_retail_cost$RetailCost_2020)
fruit_2022_avg <- mean(fruit_retail_cost$RetailCost_2022)
fruits_yearly <- data.frame(Year=c(2013, 2016, 2020, 2022),
Avg_Cost=c(fruit_2013_avg, fruit_2016_avg, fruit_2020_avg, fruit_2022_avg))
fruits_yearly
# Let's do a regression analysis first before hypothesis
model_fruits <- lm(Avg_Cost ~ Year, data = fruits_yearly)
summary(model_fruits)
ggplot(fruit_yearly, aes(x = Year, y = Avg_Cost)) +
geom_line() +
geom_smooth(method = "lm", se = FALSE, col = "red") +
labs(title = "Trend of Average Fruit Cost Over Time",
y = "Average Cost", x = "Year")
ggplot(fruits_yearly, aes(x = Year, y = Avg_Cost)) +
geom_line() +
geom_smooth(method = "lm", se = FALSE, col = "red") +
labs(title = "Trend of Average Fruit Cost Over Time",
y = "Average Cost", x = "Year")
fruits_yearly$Period <- ifelse(fruits_yearly$Year < 2020, "Before2020", "After2020")
t.test(Avg_Cost ~ Period, data = fruits_yearly)
# Let's see for vegetables now
print(veg_retail_cost)
veg_2013_avg <- mean(veg_retail_cost$RetailCost_2013)
veg_2016_avg <- mean(veg_retail_cost$RetailCost_2016)
veg_2020_avg <- mean(veg_retail_cost$RetailCost_2020)
veg_2022_avg <- mean(veg_retail_cost$RetailCost_2022)
veg_yearly <- data.frame(Year=c(2013, 2016, 2020, 2022),
Avg_Cost=c(veg_2013_avg, veg_2016_avg, veg_2020_avg, veg_2022_avg))
veg_yearly
# Let's do a regression analysis first before hypothesis
model_veg <- lm(Avg_Cost ~ Year, data = veg_yearly)
summary(model_veg)
# Since the p-value > 0.05, it tells us that there is no significant increase in the prices over the years, but let's verify this with a hypothesis test.
veg_yearly$Period <- ifelse(veg_yearly$Year < 2020, "Before2020", "After2020")
t.test(Avg_Cost ~ Period, data = veg_yearly)
# Since the p-value > 0.05 for the t-test we can conclude that there exist no evidence that the prices significantly increased for fruits after 2022.
# Let's do a regression analysis first before hypothesis
model_fruits <- lm(Avg_Cost ~ Year, data = fruits_yearly)
summary(model_fruits)
# Since the p-value > 0.05, it tells us that there is no significant increase in the prices over the years, but let's verify this with a hypothesis test.
new_data <- data.frame(Year = 2018)
predicted_cost <- predict(model_fruits, newdata = new_data)
predicted_cost
fruits_reshaped <- read.csv("Fruits_Retail_Cost_reshaped.csv")
fruits_reshaped
reshaped_model <- lm(RetailCost ~ Year + Fruits, data = fruits_reshaped)
reshaped_model
reshaped_model <- lm(RetailCost ~ Year * Fruits, data = fruits_reshaped)
reshaped_model
reshaped_model <- lm(RetailCost ~ Year, Fruits, data = fruits_reshaped)
reshaped_model <- lm(RetailCost ~ Year + Fruits, data = fruits_reshaped)
reshaped_model
reshaped_model <- lm(RetailCost ~ Year * Fruits, data = fruits_reshaped)
reshaped_model
predict_data <- data.frame(
Year = 2018,
Fruits = "Apples"
)
fruit_predict_results <- predict(reshaped_model, newdata = predict_data)
fruit_predict_results
predict_data <- data.frame(
Year = 2023,
Fruits = "Apples"
)
fruit_predict_results <- predict(reshaped_model, newdata = predict_data)
fruit_predict_results
predict_data <- data.frame(
Year = 2002,
Fruits = "Apples"
)
fruit_predict_results <- predict(reshaped_model, newdata = predict_data)
fruit_predict_results
predict_data <- data.frame(
Year = 2030,
Fruits = "Apples"
)
fruit_predict_results <- predict(reshaped_model, newdata = predict_data)
fruit_predict_results
predict_data <- data.frame(
Year = 2019,
Fruits = "Apples"
)
fruit_predict_results <- predict(reshaped_model, newdata = predict_data)
fruit_predict_results
# Prediction of price for vegetables
veg_reshaped <- read.csv("Veg_Retail_Cost_reshaped.csv")
veg_reshaped
reshaped_model_veg <- lm(RetailCost ~ Year * Vegetables, data = veg_reshaped)
reshaped_model_veg
# Predict price of vegetables
predict_data_veg <- data.frame(
Year = 2017,
Vegetables = "Avacados"
)
veg_predict_results <- predict(reshaped_model_fruit, newdata = predict_data_veg)
# Predict price of vegetables
predict_data_veg <- data.frame(
Year = 2017,
Vegetables = "Avacados"
)
veg_predict_results <- predict(reshaped_model_veg, newdata = predict_data_veg)
# Predict price of vegetables
predict_data_veg <- data.frame(
Year = 2017,
Vegetables = "Avocados"
)
veg_predict_results <- predict(reshaped_model_veg, newdata = predict_data_veg)
veg_predict_results
reshaped_model_fruit <- lm(RetailCost ~ Year * Fruits, data = fruits_reshaped)
reshaped_model_fruit
# Predict price of fruits
predict_data_fruit <- data.frame(
Year = 2019,
Fruits = "Apples"
)
fruit_predict_results <- predict(reshaped_model_fruit, newdata = predict_data_fruit)
fruit_predict_results
summary(reshaped_model_fruit)
summary(reshaped_model_veg)
# Hypothesis test
veg_yearly$Period <- ifelse(veg_yearly$Year < 2020, "Before2020", "After2020")
veg_yearly
#t.test(Avg_Cost ~ Period, data = veg_yearly)
# Since the p-value > 0.05 for the t-test we can conclude that there exist no evidence that the prices significantly increased for vegetables after 2022.
# Hypothesis test
veg_yearly$Period <- ifelse(veg_yearly$Year < 2020, "Before2020", "After2020")
anova_result <- aov(Avg_Cost ~ Year, data = veg_yearly)
anova_result
# Since the p-value > 0.05 for the t-test we can conclude that there exist no evidence that the prices significantly increased for vegetables after 2022.
# Hypothesis test
veg_yearly$Period <- ifelse(veg_yearly$Year < 2020, "Before2020", "After2020")
anova_result <- aov(Avg_Cost ~ Year, data = veg_yearly)
summary(anova_result)
# Since the p-value > 0.05 for the t-test we can conclude that there exist no evidence that the prices significantly increased for vegetables after 2022.
# Hypothesis test
fruits_yearly$Period <- ifelse(fruits_yearly$Year < 2020, "Before2020", "After2020")
anova_results_fruit <- aov(Avg_Cost ~ Year, data = fruits_yearly)
summary(anova_results_fruit)
# Since the p-value > 0.05 for the t-test we can conclude that there exist no evidence that the prices significantly increased for fruits after 2022.
shapiro.test(residuals(reshaped_model_fruit))
shapiro.test(residuals(reshaped_model_veg))
# Identify influential points
influence_measures(reshaped_model_veg)
library(car)
install.packages("car")
library(car)
# Identify influential points
influence_measures(reshaped_model_veg)
# Print rows that might be influential
veg_reshaped[outliers, ]
# Calculate Cook's distance
cooks_d <- cooks.distance(reshaped_model_veg)
# Plot Cook's distance
plot(cooks_d, type = "h", main = "Cook's Distance", ylab = "Distance")
abline(h = 4/length(cooks_d), col = "red", lty = 2)  # Threshold line
# Identify which points exceed the threshold
which(cooks_d > (4 / length(cooks_d)))
# Leverage (hat values)
lev <- hatvalues(reshaped_model_veg)
# Standardized residuals
std_resid <- rstandard(reshaped_model_veg)
# Combine to find high-leverage outliers
outliers <- which(abs(std_resid) > 2 & lev > (2 * mean(lev)))
outliers
# Print rows that might be influential
veg_reshaped[outliers, ]
# Calculate Cook's distance
cooks_d <- cooks.distance(reshaped_model_veg)
# Plot Cook's distance
plot(cooks_d, type = "h", main = "Cook's Distance", ylab = "Distance")
abline(h = 4/length(cooks_d), col = "red", lty = 2)  # Threshold line
# Identify which points exceed the threshold
which(cooks_d > (4 / length(cooks_d)))
reshaped_model_log <- lm(log(RetailCost) ~ Year * Fruits, data = fruits_reshaped)
shapiro.test(residuals(reshaped_model_log))
qqnorm(residuals(reshaped_model_fruit)); qqline(residuals(reshaped_model_fruit), col = "red")
qqnorm(residuals(reshaped_model_veg)); qqline(residuals(reshaped_model_veg), col = "blue")
ggsave("Fruit_2022_Barplot.png", ggplot(dataFruit, aes(x = data.RetailCostPer.Pound.PintF2022, y = data.Fruit2022, color = data.FormF2022, shape = data.FormF2022)) + geom_bar(position = "dodge", stat = "identity") + theme_gray(base_size = 7), width = 8, height = 6, units = "in")
# Load ggplot2
library(ggplot2)
data <- read.csv("ProjectData.csv")
dataFruit <- data.frame(
data$Fruit2022, data$FormF2022, data$RetailCostPer.Pound.PintF2022,
data$Fruit2020, data$FormF2020, data$RetailCostPer.Pound.PintF2020,
data$Fruit2016, data$FormF2016, data$RetailCostPer.Pound.PintF2016,
data$Fruit2013, data$FormF2013, data$RetailCostPer.Pound.PintF2013
)
dataVeg <- data.frame(
data$Vegetable2022, data$FormV2022, data$RetailCostPer.Pound.PintV2022,
data$Vegetable2020, data$FormV2020, data$RetailCostPer.Pound.PintV2020,
data$Vegetable2016, data$FormV2016, data$RetailCostPer.Pound.PintV2016,
data$Vegetable2013, data$FormV2013, data$RetailCostPer.Pound.PintV2013
)
#Clean up the fruit/veg data (remove na rows):
print("Note: Some fruits/vegetables do not have price data for all 4 years can be excluded (example: Zucchinis only have data in 2022/2020)")
dataFruit <- na.omit(dataFruit)
dataVeg <- na.omit(dataVeg)
# Barplot
ggplot(dataFruit, aes(x=data.RetailCostPer.Pound.PintF2022, y=data.Fruit2022, color = data.FormF2022, shape = data.FormF2022)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataFruit, aes(x=data.RetailCostPer.Pound.PintF2020, y=data.Fruit2020, color = data.FormF2020, shape = data.FormF2020)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataFruit, aes(x=data.RetailCostPer.Pound.PintF2016, y=data.Fruit2016, color = data.FormF2016, shape = data.FormF2016)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataFruit, aes(x=data.RetailCostPer.Pound.PintF2013, y=data.Fruit2013, color = data.FormF2013, shape = data.FormF2013)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataVeg, aes(x=data.RetailCostPer.Pound.PintV2022, y=data.Vegetable2022, color = data.FormV2022, shape = data.FormV2022)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataVeg, aes(x=data.RetailCostPer.Pound.PintV2020, y=data.Vegetable2020, color = data.FormV2020, shape = data.FormV2020)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataVeg, aes(x=data.RetailCostPer.Pound.PintV2016, y=data.Vegetable2016, color = data.FormV2013, shape = data.FormV2016)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
ggplot(dataVeg, aes(x=data.RetailCostPer.Pound.PintV2013, y=data.Vegetable2013, color = data.FormV2013, shape = data.FormV2013)) + geom_bar(position="dodge", stat = "identity") + theme_gray(base_size = 7)
#U.S. Department of Agriculture, Economic Research Service. (2024). Fruit and vegetable prices.
#Large variance in fruit prices
ggsave("Fruit_2022_Barplot.png", ggplot(dataFruit, aes(x = data.RetailCostPer.Pound.PintF2022, y = data.Fruit2022, color = data.FormF2022, shape = data.FormF2022)) + geom_bar(position = "dodge", stat = "identity") + theme_gray(base_size = 7), width = 8, height = 6, units = "in")
ggsave("Fruit_2020_Barplot.png", ggplot(dataFruit, aes(x = data.RetailCostPer.Pound.PintF2020, y = data.Fruit2020, color = data.FormF2020, shape = data.FormF2020)) + geom_bar(position = "dodge", stat = "identity") + theme_gray(base_size = 7), width = 8, height = 6, units = "in")
ggsave("Fruit_2016_Barplot.png", ggplot(dataFruit, aes(x = data.RetailCostPer.Pound.PintF2016, y = data.Fruit2016, color = data.FormF2016, shape = data.FormF2016)) + geom_bar(position = "dodge", stat = "identity") + theme_gray(base_size = 7), width = 8, height = 6, units = "in")
ggsave("Fruit_2013_Barplot.png", ggplot(dataFruit, aes(x = data.RetailCostPer.Pound.PintF2013, y = data.Fruit2013, color = data.FormF2013, shape = data.FormF2013)) + geom_bar(position = "dodge", stat = "identity") + theme_gray(base_size = 7), width = 8, height = 6, units = "in")
ggsave("Vegetable_2022_Barplot.png", ggplot(dataVeg, aes(x = data.RetailCostPer.Pound.PintV2022, y = data.Vegetable2022, color = data.FormV2022, shape = data.FormV2022)) + geom_bar(position = "dodge", stat = "identity") + theme_gray(base_size = 7), width = 8, height = 6, units = "in")
ggsave("Vegetable_2020_Barplot.png", ggplot(dataVeg, aes(x = data.RetailCostPer.Pound.PintV2020, y = data.Vegetable2020, color = data.FormV2020, shape = data.FormV2020)) + geom_bar(position = "dodge", stat = "identity") + theme_gray(base_size = 7), width = 8, height = 6, units = "in")
ggsave("Vegetable_2016_Barplot.png", ggplot(dataVeg, aes(x = data.RetailCostPer.Pound.PintV2016, y = data.Vegetable2016, color = data.FormV2016, shape = data.FormV2016)) + geom_bar(position = "dodge", stat = "identity") + theme_gray(base_size = 7), width = 8, height = 6, units = "in")
ggsave("Vegetable_2013_Barplot.png", ggplot(dataVeg, aes(x = data.RetailCostPer.Pound.PintV2013, y = data.Vegetable2013, color = data.FormV2013, shape = data.FormV2013)) + geom_bar(position = "dodge", stat = "identity") + theme_gray(base_size = 7), width = 8, height = 6, units = "in")
# Let's do a hypothesis test to verify if the mean costs of fruits have significantly changed before vs. after 2020
print(fruit_retail_cost)
fruit_2013_avg <- mean(fruit_retail_cost$RetailCost_2013)
fruit_2016_avg <- mean(fruit_retail_cost$RetailCost_2016)
fruit_2020_avg <- mean(fruit_retail_cost$RetailCost_2020)
fruit_2022_avg <- mean(fruit_retail_cost$RetailCost_2022)
fruits_yearly <- data.frame(Year=c(2013, 2016, 2020, 2022),
Avg_Cost=c(fruit_2013_avg, fruit_2016_avg, fruit_2020_avg, fruit_2022_avg))
fruits_yearly
# Fruit trend
plot(fruits_yearly$Year, fruits_yearly$Avg_Cost, main = "Fruit Cost Trend", xlab = "Year", ylab = "Average Cost")
abline(fruit_lm, col = "blue")
